import{A as It,B as Rt,C as Lt,D as At,E as Dt,F as Ot,G as Tt,H as Pt,I as kt,J as zt,h as mt,i as dt,j as ut,k as ht,l as wt,m as gt,n as bt,o as I,p as ft,q as R,r as Ct,s as St,t as yt,u as xt,v as _t,w as Et,x as Mt,y as $t,z as jt}from"./chunk-IYKYTTCZ.js";import{$a as _,A as W,E as q,F as Q,Fc as ct,Gc as pt,J as $,La as d,Oa as K,P as y,Pa as u,Pb as nt,Qa as Z,R as T,Ra as tt,Rb as ot,Sb as st,Tb as lt,U as G,Ya as n,Za as i,_ as j,_a as b,a as H,ab as E,ba as Y,cb as et,eb as at,f as U,fb as P,g as C,ia as X,ja as J,jb as k,kb as z,l as N,lb as B,o as F,pb as o,rb as x,tb as rt,ub as it,v as V,vb as h,wb as w,xa as c,y as M}from"./chunk-3WTAWFIT.js";import{a as vt}from"./chunk-3VX3SZL2.js";import"./chunk-AP4OEWII.js";var L=class t{apiUrl=vt.apiUrl;http=j(lt);getCharacters(e=1,a=10,r="",s=""){let p=`${this.apiUrl}people?page=${e}&limit=${a}&expanded=true`;return r&&s&&(p+=`&sort_by=${r}&sort_direction=${s}`),console.log(`API Request URL: ${p}`),this.http.get(p).pipe($(2),M(this.handleError))}getCharacter(e){return this.http.get(`${this.apiUrl}people/${e}`).pipe($(2),F(a=>a.result.properties),M(this.handleError))}searchCharacters(e,a=1,r=10,s="",p=""){let m=`${this.apiUrl}people?name=${encodeURIComponent(e)}&page=${a}&limit=${r}&expanded=true`;return s&&p&&(m+=`&sort_by=${s}&sort_direction=${p}`),console.log(`API Search Request URL: ${m}`),this.http.get(m).pipe($(2),M(this.handleError))}handleError(e){let a="The Force is disturbed";return e.error instanceof ErrorEvent?a=`Error: ${e.error.message}`:a=`Error Code: ${e.status}
Message: ${e.message}`,console.error(a),N(()=>new Error(a))}static \u0275fac=function(a){return new(a||t)};static \u0275prov=G({token:t,factory:t.\u0275fac,providedIn:"root"})};var A=class extends mt{constructor(a){super();this.starWarsService=a}charactersSubject=new C([]);loadingSubject=new C(!1);countSubject=new C(0);pageSubject=new C(1);pageSizeSubject=new C(10);sortSubject=new C(null);searchSubject=new C("");loading$=this.loadingSubject.asObservable();count$=this.countSubject.asObservable();page$=this.pageSubject.asObservable();pageSize$=this.pageSizeSubject.asObservable();sort$=this.sortSubject.asObservable();search$=this.searchSubject.asObservable();subscription=new H;connect(){return this.charactersSubject.asObservable()}disconnect(){this.charactersSubject.complete(),this.loadingSubject.complete(),this.countSubject.complete(),this.pageSubject.complete(),this.pageSizeSubject.complete(),this.sortSubject.complete(),this.searchSubject.complete(),this.subscription.unsubscribe()}loadCharacters(a=1,r="",s="",p=this.pageSizeSubject.value,m=""){this.loadingSubject.next(!0),this.pageSubject.next(a),this.pageSizeSubject.next(p),this.searchSubject.next(m),r&&this.sortSubject.next({active:r,direction:s}),console.log(`Loading characters: page=${a}, pageSize=${p}, sort=${r}, direction=${s}, search=${m}`);let g=(m?this.starWarsService.searchCharacters(m,a,p,r,s):this.starWarsService.getCharacters(a,p,r,s)).pipe(Q(()=>this.loadingSubject.next(!1))).subscribe({next:l=>{let f=[],S=0;"result"in l&&Array.isArray(l.result)?(f=l.result.map(v=>v.properties).filter(v=>v!==void 0),S=f.length,console.log("Search response processed:",{characters:f,totalCount:S})):"results"in l&&Array.isArray(l.results)&&(f=l.results.map(v=>v.properties).filter(v=>v!==void 0),S=l.total_records||0,console.log("Regular response processed:",{characters:f,totalCount:S}));let Ht=this.applySorting(f);this.charactersSubject.next(Ht),this.countSubject.next(S)},error:l=>{console.error("Error loading characters:",l),this.charactersSubject.next([]),this.countSubject.next(0),this.loadingSubject.next(!1)}});this.subscription.add(g)}getData(){return this.charactersSubject.value}getCurrentPage(){return this.pageSubject.value}getCurrentPageSize(){return this.pageSizeSubject.value}applySorting(a){let r=this.sortSubject.value;return!r||!r.active||!r.direction?a:[...a].sort((s,p)=>{let m=r.active,D=r.direction==="asc"?1:-1,O=(f,S)=>String(f[S]||""),g=O(s,m),l=O(p,m);return m==="height"||m==="mass"?(g=g==="unknown"?-1:parseFloat(String(g)),l=l==="unknown"?-1:parseFloat(String(l))):m==="birth_year"&&(g=g==="unknown"?-99999:parseFloat(String(g)),l=l==="unknown"?-99999:parseFloat(String(l))),g<l?-1*D:g>l?1*D:0})}clear(){this.charactersSubject.next([]),this.countSubject.next(0),this.pageSubject.next(1),this.pageSizeSubject.next(10),this.sortSubject.next(null),this.searchSubject.next("")}};var Nt=()=>[5,10,25,50];function Ft(t,e){if(t&1){let a=et();n(0,"button",32),at("click",function(){X(a);let s=P();return J(s.clearSearch())}),n(1,"mat-icon"),o(2,"close"),i()()}}function Vt(t,e){t&1&&(n(0,"span"),o(1,"Loading galactic personnel data. Please wait."),i())}function Wt(t,e){t&1&&(n(0,"span"),o(1,"No personnel records found matching your search criteria."),i())}function qt(t,e){if(t&1&&(n(0,"span"),o(1),h(2,"async"),i()),t&2){let a=P();c(),x("",w(2,1,a.dataSource.count$)," personnel records found.")}}function Qt(t,e){t&1&&(n(0,"th",33)(1,"div",10)(2,"mat-icon",34),o(3,"person"),i(),n(4,"span"),o(5,"NAME"),i()()())}function Gt(t,e){if(t&1&&(n(0,"td",35),o(1),i()),t&2){let a=e.$implicit;c(),x(" ",a.name," ")}}function Yt(t,e){t&1&&(n(0,"th",33)(1,"div",10)(2,"mat-icon",34),o(3,"wc"),i(),n(4,"span"),o(5,"GENDER"),i()()())}function Xt(t,e){if(t&1&&(n(0,"td",36),o(1),i()),t&2){let a=e.$implicit;c(),x(" ",a.gender," ")}}function Jt(t,e){t&1&&(n(0,"th",37)(1,"div",10)(2,"mat-icon",34),o(3,"cake"),i(),n(4,"span"),o(5,"BIRTH YEAR"),i()()())}function Kt(t,e){if(t&1&&(n(0,"td",36),o(1),i()),t&2){let a=e.$implicit;c(),x(" ",a.birth_year," ")}}function Zt(t,e){t&1&&(n(0,"th",37)(1,"div",10)(2,"mat-icon",34),o(3,"height"),i(),n(4,"span"),o(5,"HEIGHT"),i()()())}function te(t,e){if(t&1&&(n(0,"td",36),o(1),i()),t&2){let a=e.$implicit;c(),x(" ",a.height,"cm ")}}function ee(t,e){t&1&&b(0,"tr",38)}function ae(t,e){t&1&&b(0,"tr",39)}function re(t,e){t&1&&(n(0,"tr",40)(1,"td",41)(2,"div",42)(3,"mat-icon",43),o(4,"warning"),i(),n(5,"span",44),o(6,"These aren't the characters you're looking for"),i()()()())}function ie(t,e){t&1&&b(0,"div",45)}function ne(t,e){t&1&&(n(0,"div",46)(1,"div",47)(2,"div",48),b(3,"div",49)(4,"div",50)(5,"mat-spinner",51),i(),n(6,"p",52),o(7," ACCESSING GALACTIC DATABASE "),i(),n(8,"p",53),o(9," IMPERIAL SECURITY PROTOCOLS ACTIVE "),i(),n(10,"div",14),o(11," Loading galactic personnel data. Please wait. "),i(),n(12,"div",54),b(13,"div",55)(14,"div",56)(15,"div",57),i()()()),t&2&&Z("top","calc(48px + 5%)")}var Bt=class t{characters=[];displayedColumns=["name","gender","birth_year","height"];pageSize=10;loading=!1;error="";totalCount=0;searchControl=new wt("");paginator;sort;starWarsService=j(L);dataSource;destroy$=new U;ngOnInit(){this.dataSource=new A(this.starWarsService),this.dataSource.connect().pipe(y(this.destroy$)).subscribe(e=>{this.characters=e}),this.dataSource.loading$.pipe(y(this.destroy$)).subscribe(e=>{this.loading=e}),this.dataSource.count$.pipe(y(this.destroy$)).subscribe(e=>{this.totalCount=e}),this.searchControl.valueChanges.pipe(W(300),q(),y(this.destroy$),T(()=>{this.paginator&&(this.paginator.pageIndex=0),this.loadCharacters()})).subscribe(),this.loadCharacters()}ngAfterViewInit(){this.paginator&&this.sort&&(this.sort.sortChange.pipe(y(this.destroy$)).subscribe(()=>{this.paginator&&(this.paginator.pageIndex=0)}),V(this.sort.sortChange,this.paginator.page).pipe(y(this.destroy$),T(()=>{this.loadCharacters()})).subscribe())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadCharacters(){this.error="";try{let e=this.paginator?this.paginator.pageIndex+1:1,a=this.paginator?this.paginator.pageSize:this.pageSize,r=this.sort?this.sort.active:"",s=this.sort?this.sort.direction:"";this.pageSize=a;let p=this.searchControl.value||"";this.dataSource.loadCharacters(e,r,s,a,p)}catch(e){this.error=`Failed to load characters: ${e instanceof Error?e.message:"Unknown error"}. The Cosmic Compiler is displeased.`}}clearSearch(){this.searchControl.setValue("")}static \u0275fac=function(a){return new(a||t)};static \u0275cmp=Y({type:t,selectors:[["app-character-list"]],viewQuery:function(a,r){if(a&1&&(k(I,5),k(R,5)),a&2){let s;z(s=B())&&(r.paginator=s.first),z(s=B())&&(r.sort=s.first)}},standalone:!0,features:[rt],decls:53,vars:36,consts:[["tableContainer",""],[1,"tw-mb-6"],[1,"tw-flex","tw-items-center","tw-mb-4"],["aria-hidden","true",1,"tw-w-8","tw-h-8","tw-bg-yellow-400","tw-rounded-full","tw-flex","tw-items-center","tw-justify-center","tw-mr-3"],[1,"tw-text-black"],["id","database-title","data-testid","character-list-heading",1,"tw-text-2xl","tw-text-yellow-400","tw-mb-0","tw-tracking-widest"],["aria-live","polite",1,"tw-flex","tw-items-center","tw-mb-1","tw-text-xs","tw-text-blue-300"],[1,"tw-tracking-wider"],[1,"tw-flex-1"],[1,"tw-mb-4","tw-border","tw-border-blue-300","tw-rounded","tw-p-2","tw-bg-gray-900"],[1,"tw-flex","tw-items-center"],[1,"tw-mr-2","tw-text-yellow-400"],["placeholder","ENTER SEARCH PARAMETERS","aria-label","Search characters","data-testid","search-input",1,"tw-bg-transparent","tw-border-none","tw-outline-none","tw-text-blue-300","tw-w-full",3,"formControl"],["mat-icon-button","","aria-label","Clear search","data-testid","clear-search-button","class","tw-text-yellow-400",3,"click",4,"ngIf"],["aria-live","polite",1,"tw-sr-only"],[4,"ngIf"],[1,"tw-relative","tw-border","tw-border-yellow-400","tw-rounded-md","tw-overflow-hidden","tw-min-h-[400px]"],["mat-table","","matSort","","data-testid","character-table",1,"tw-w-full","tw-bg-gray-900","tw-shadow-md",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","","class","tw-text-yellow-400","scope","col",4,"matHeaderCellDef"],["mat-cell","","class","tw-text-yellow-400 tw-font-medium","data-testid","character-name",4,"matCellDef"],["matColumnDef","gender"],["mat-cell","","class","tw-text-blue-300",4,"matCellDef"],["matColumnDef","birth_year"],["mat-header-cell","","mat-sort-header","","class","tw-text-yellow-400",4,"matHeaderCellDef"],["matColumnDef","height"],["mat-header-row","","class","tw-bg-gray-800",4,"matHeaderRowDef"],["mat-row","","class","tw-border-b tw-border-gray-700 hover:tw-bg-gray-800 focus:tw-outline focus:tw-outline-2 focus:tw-outline-yellow-400","role","row",4,"matRowDef","matRowDefColumns"],["class","tw-mat-row",4,"matNoDataRow"],["aria-label","Select page of characters",1,"tw-bg-gray-900","tw-text-yellow-400","tw-border-t","tw-border-yellow-400",3,"length","pageSize","pageSizeOptions"],["class","tw-absolute tw-inset-0 tw-z-40 tw-bg-black tw-bg-opacity-70","aria-hidden","true",4,"ngIf"],["class","tw-absolute tw-left-0 tw-right-0 tw-z-50 tw-flex tw-items-center tw-justify-center tw-py-8","role","status","aria-live","polite","style","height: auto; min-height: 180px",3,"top",4,"ngIf"],["mat-icon-button","","aria-label","Clear search","data-testid","clear-search-button",1,"tw-text-yellow-400",3,"click"],["mat-header-cell","","mat-sort-header","","scope","col",1,"tw-text-yellow-400"],["aria-hidden","true",1,"tw-mr-1","tw-text-base","tw-text-yellow-400"],["mat-cell","","data-testid","character-name",1,"tw-text-yellow-400","tw-font-medium"],["mat-cell","",1,"tw-text-blue-300"],["mat-header-cell","","mat-sort-header","",1,"tw-text-yellow-400"],["mat-header-row","",1,"tw-bg-gray-800"],["mat-row","","role","row",1,"tw-border-b","tw-border-gray-700","hover:tw-bg-gray-800","focus:tw-outline","focus:tw-outline-2","focus:tw-outline-yellow-400"],[1,"tw-mat-row"],["colspan","4",1,"tw-mat-cell","tw-p-4","tw-text-center"],[1,"tw-flex","tw-flex-col","tw-items-center","tw-py-8"],[1,"tw-text-4xl","tw-text-yellow-400","tw-mb-2"],[1,"tw-text-blue-300"],["aria-hidden","true",1,"tw-absolute","tw-inset-0","tw-z-40","tw-bg-black","tw-bg-opacity-70"],["role","status","aria-live","polite",1,"tw-absolute","tw-left-0","tw-right-0","tw-z-50","tw-flex","tw-items-center","tw-justify-center","tw-py-8",2,"height","auto","min-height","180px"],[1,"tw-flex","tw-flex-col","tw-items-center","tw-p-6","tw-border-2","tw-border-yellow-400","tw-rounded-lg","tw-bg-gray-900","tw-bg-opacity-90","tw-shadow-lg","tw-shadow-yellow-400/20"],[1,"tw-flex","tw-items-center","tw-justify-center","tw-mb-3","tw-relative"],["aria-hidden","true",1,"tw-animate-ping","tw-absolute","tw-h-12","tw-w-12","tw-rounded-full","tw-bg-yellow-400","tw-opacity-20"],["aria-hidden","true",1,"tw-animate-ping","tw-absolute","tw-h-16","tw-w-16","tw-rounded-full","tw-bg-yellow-400","tw-opacity-10","tw-delay-300"],["color","accent","diameter","50","aria-label","Loading data"],[1,"tw-text-yellow-400","tw-tracking-widest","tw-text-center","tw-font-bold","tw-text-lg"],[1,"tw-text-blue-300","tw-text-xs","tw-mt-1","tw-text-center"],["aria-hidden","true",1,"tw-flex","tw-justify-center","tw-gap-2","tw-mt-3"],[1,"tw-w-2","tw-h-2","tw-bg-yellow-400","tw-animate-pulse"],[1,"tw-w-2","tw-h-2","tw-bg-yellow-400","tw-animate-pulse","tw-delay-150"],[1,"tw-w-2","tw-h-2","tw-bg-yellow-400","tw-animate-pulse","tw-delay-300"]],template:function(a,r){if(a&1&&(n(0,"div",1)(1,"div",2)(2,"div",3)(3,"mat-icon",4),o(4,"people"),i()(),n(5,"h1",5),o(6," GALACTIC PERSONNEL DATABASE "),i()(),n(7,"div",6)(8,"span",7),o(9,"IMPERIAL SECURITY CLEARANCE REQUIRED"),i(),b(10,"span",8),n(11,"span",7),o(12),h(13,"async"),i()(),n(14,"div",9)(15,"div",10)(16,"mat-icon",11),o(17,"search"),i(),b(18,"input",12),d(19,Ft,3,0,"button",13),i()(),n(20,"div",14),d(21,Vt,2,0,"span",15),h(22,"async"),d(23,Wt,2,0,"span",15),h(24,"async"),h(25,"async"),d(26,qt,3,3,"span",15),h(27,"async"),h(28,"async"),i(),n(29,"div",16,0)(31,"table",17),_(32,18),d(33,Qt,6,0,"th",19)(34,Gt,2,1,"td",20),E(),_(35,21),d(36,Yt,6,0,"th",19)(37,Xt,2,1,"td",22),E(),_(38,23),d(39,Jt,6,0,"th",24)(40,Kt,2,1,"td",22),E(),_(41,25),d(42,Zt,6,0,"th",24)(43,te,2,1,"td",22),E(),d(44,ee,1,0,"tr",26)(45,ae,1,0,"tr",27)(46,re,7,0,"tr",28),i(),b(47,"mat-paginator",29),h(48,"async"),d(49,ie,1,0,"div",30),h(50,"async"),d(51,ne,16,2,"div",31),h(52,"async"),i()()),a&2){let s;c(12),x("SYSTEM ID: SW-",w(13,17,r.dataSource.count$),"-X"),c(6),u("formControl",r.searchControl),c(),u("ngIf",r.searchControl.value),c(2),u("ngIf",w(22,19,r.dataSource.loading$)),c(2),u("ngIf",w(24,21,r.dataSource.loading$)===!1&&w(25,23,r.dataSource.count$)===0),c(3),u("ngIf",w(27,25,r.dataSource.loading$)===!1&&((s=w(28,27,r.dataSource.count$))!==null&&s!==void 0?s:0)>0),c(5),tt("tw-opacity-50",r.loading&&r.characters.length),u("dataSource",r.dataSource),K("data-state",r.loading&&r.characters.length?"dimmed":"normal"),c(13),u("matHeaderRowDef",r.displayedColumns),c(),u("matRowDefColumns",r.displayedColumns),c(2),u("length",w(48,29,r.dataSource.count$))("pageSize",10)("pageSizeOptions",it(35,Nt)),c(2),u("ngIf",w(50,31,r.dataSource.loading$)),c(2),u("ngIf",w(52,33,r.dataSource.loading$))}},dependencies:[st,nt,ot,bt,ut,ht,gt,Dt,yt,_t,jt,Et,xt,It,Mt,$t,Rt,Lt,At,ft,I,St,R,Ct,Tt,Ot,kt,Pt,pt,ct,dt,zt],styles:["[_nghost-%COMP%]     .mat-mdc-paginator{background-color:transparent}[_nghost-%COMP%]     .mat-mdc-paginator-range-label, [_nghost-%COMP%]     .mat-mdc-paginator-page-size-label{color:var(--star-wars-blue)}[_nghost-%COMP%]     .mat-mdc-paginator-icon{fill:var(--star-wars-yellow)}[_nghost-%COMP%]     .mat-mdc-select-value-text{color:var(--star-wars-yellow)}[_nghost-%COMP%]     .mat-mdc-select-arrow{color:var(--star-wars-yellow)}.mat-mdc-row[_ngcontent-%COMP%]:nth-child(2n){background-color:#1414144d}.mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#32323280}.mat-mdc-cell[_ngcontent-%COMP%], .mat-mdc-header-cell[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:none}.mat-mdc-header-cell[_ngcontent-%COMP%]{background-color:#00000080;font-weight:600;color:var(--star-wars-yellow);font-size:.8rem;text-transform:uppercase}.mat-mdc-cell[_ngcontent-%COMP%]{color:var(--star-wars-blue)}"]})};export{Bt as CharacterListComponent};
